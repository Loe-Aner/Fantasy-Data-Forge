USE WoW_PL
;

CREATE TABLE dbo.ZRODLO (
  TECH_ID BIGINT IDENTITY(1, 1)      NOT NULL,

  MISJA_ID_MOJE_FK BIGINT            NOT NULL,

  ZRODLO_NAZWA NVARCHAR(20)          NOT NULL
    CHECK (ZRODLO_NAZWA IN (N'wiki', N'wowhead', N'wowdb', N'recznie', N'z addonu')),

  DATA_WYSCRAPOWANIA DATETIME2  NOT NULL DEFAULT SYSDATETIME(),

  HTML_HASH_GLOWNY_CEL CHAR(64)     NULL,
  HTML_HASH_PODRZEDNY_CEL CHAR(64)  NULL,
  HTML_HASH_TRESC CHAR(64)          NULL,
  HTML_HASH_POSTEP CHAR(64)         NULL,
  HTML_HASH_ZAKONCZENIE CHAR(64)    NULL,
  HTML_HASH_NAGRODY CHAR(64)        NULL,
  HTML_HASH_DYMKI CHAR(64)          NULL,
  HTML_HASH_GOSSIP CHAR(64)         NULL,

  CONSTRAINT PK_ZRODLO PRIMARY KEY (TECH_ID),

  CONSTRAINT FK_ZRODLO_MISJE
    FOREIGN KEY (MISJA_ID_MOJE_FK) REFERENCES dbo.MISJE(MISJA_ID_MOJE_PK)
)
;

CREATE INDEX IX_ZRODLO_MISJA
ON dbo.ZRODLO (MISJA_ID_MOJE_FK, DATA_WYSCRAPOWANIA DESC)
;